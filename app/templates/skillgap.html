{% extends 'base.html' %}

{% block content %}
<div class="section-header text-center mb-8">
    <h1 class="text-4xl font-bold text-blue-600 mb-4">Analyse your profile</h1>
    <p class="text-lg text-gray-600">Get detailed skill gap for your desired role</p>
</div>

<!-- Skill Gap Analysis Form -->
<div class="skillgap-form text-center">
    <form id="skillForm" method="POST" action="/analyze_skills">
        <label for="skills" class="text-lg font-semibold">Enter your skills (comma-separated):</label><br>
        <input type="text" id="skills" name="skills" placeholder="e.g., Python, Flask, MongoDB" class="w-full border rounded p-2 mb-4"><br>
        <button type="submit" class="btn bg-blue-600 text-white font-semibold py-2 px-4 rounded hover:bg-blue-700 transition">Analyze My Skills</button>
    </form>
</div>

<!-- Result Section -->
<div id="results" class="mt-8">
    <!-- Skill gap analysis and recommendations will appear here -->
</div>

<script>
  document.getElementById('skillForm').addEventListener('submit', async function (e) {
    e.preventDefault();

    const formData = new FormData(this);
    const response = await fetch('/analyze_skills', {
      method: 'POST',
      body: formData
    });

    const result = await response.json();

    if (result.gap_analysis && result.recommendations) {
      let gapHtml = "<h3 class='text-2xl font-bold text-red-600'>Skill Gaps</h3><ul>";
      result.gap_analysis.forEach(skill => {
        gapHtml += `<li>${skill}</li>`;
      });
      gapHtml += "</ul>";

      let recHtml = "<h3 class='text-2xl font-bold text-green-600'>Recommendations</h3><ul>";
      result.recommendations.forEach(rec => {
        recHtml += `<li>${rec.skill}: ${rec.course} | ${rec.job}</li>`;
      });
      recHtml += "</ul>";

      document.getElementById('results').innerHTML = gapHtml + recHtml;
    }
  });
</script>
{% endblock %}
